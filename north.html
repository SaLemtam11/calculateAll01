<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø´Ù…Ø§Ù„ </title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
            direction: rtl;
            text-align: center;
        }

        h2 {
            color: #333;
            margin-top: 20px;
            font-size: 28px;
            font-weight: bold;
        }

        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .back-button {
            display: inline-block;
            margin: 20px auto;
            padding: 12px 20px;
            background-color: #007bff;
            color: #fff;
            text-decoration: none;
            border-radius: 8px;
            font-size: 16px;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .back-button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px;
            text-align: center;
            border: 1px solid #ddd;
        }

        th {
            background-color: #007bff;
            color: white;
            font-size: 16px;
        }

        td {
            background-color: #f8f9fa;
            font-size: 14px;
            color: #555;
        }

        input[type="date"], input[type="time"], input[type="number"], select {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: #f1f1f1;
            font-size: 14px;
        }

        button {
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        button:hover {
            background-color: #218838;
            transform: scale(1.05);
        }

        .add-button, .calculate-button, .download-button {
            margin-top: 20px;
        }

        button:focus {
            outline: none;
        }

        .info {
            font-size: 14px;
            color: #007bff;
            margin-top: 20px;
        }

        .info a {
            color: #007bff;
            text-decoration: none;
        }

        .info a:hover {
            text-decoration: underline;
        }

        .remove-button {
            background-color: #dc3545;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .remove-button:hover {
            background-color: #c82333;
        }

        .result-row {
            background-color: #e9ecef;
        }

        .total-row {
            background-color: #d4edda;
            font-weight: bold;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .total-row p {
            margin: 5px 0;
            font-size: 18px;
            color: #333;
        }

        @media screen and (max-width: 768px) {
            h2 {
                font-size: 22px;
            }

            .container {
                width: 90%;
                padding: 15px;
            }

            th, td {
                font-size: 12px;
                padding: 8px;
            }

            button {
                font-size: 14px;
                padding: 8px 16px;
                margin: 5px;
            }

            input[type="date"], input[type="time"], input[type="number"], select {
                font-size: 12px;
            }
        }

        @media screen and (max-width: 480px) {
            th, td {
                font-size: 10px;
                padding: 6px;
            }

            button {
                font-size: 12px;
                padding: 6px 12px;
            }

            .container {
                width: 95%;
                padding: 10px;
            }

            .add-button, .calculate-button, .download-button {
                width: 100%;
                font-size: 14px;
                margin-top: 15px;
            }

            input[type="date"], input[type="time"], input[type="number"], select {
                font-size: 10px;
                padding: 6px;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <h2> Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª  Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø´Ù…Ø§Ù„ </h2>
    <a href="index.html" class="back-button">Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>

    <div class="container">
        <table>
            <thead>
                <tr>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</th>
                    <th>Ø³Ø§Ø¹Ø© Ø§Ù„Ø°Ù‡Ø§Ø¨</th>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø¬ÙˆØ¹</th>
                    <th>Ø³Ø§Ø¹Ø© Ø§Ù„Ø±Ø¬ÙˆØ¹</th>
                    <th>Ø§Ù„Ù…Ø³Ø§ÙØ© (ÙƒÙ…)</th>
                    <th>Ø§Ù„ØµÙ†Ù</th>
                    <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                </tr>
            </thead>
            <tbody id="inputTableBody">
                <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø© Ù‡Ù†Ø§ -->
            </tbody>
        </table>
        <button class="add-button" onclick="addRow()">â• Ø¥Ø¶Ø§ÙØ© ØªØ§Ø±ÙŠØ® Ø¬Ø¯ÙŠØ¯</button>
        <button class="calculate-button" onclick="calculateAll()">ğŸ“Š Ø§Ø­Ø³Ø¨</button>
        <button class="download-button" onclick="downloadExcel()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Excel</button>

        <table>
            <thead>
                <tr>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨</th>
                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø¬ÙˆØ¹</th>
                    <th>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª (ØºØ¯Ø§Ø¡ ÙˆØ¹Ø´Ø§Ø¡)</th>
                    <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù„ÙŠØ§Ù„ÙŠ (Ø§Ù„Ù…Ø¨ÙŠØª)</th>
                    <th>Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© (Ø¯Ø¬)</th>
                    <th>Ø§Ù„ØµÙ†Ù</th>
                </tr>
            </thead>
            <tbody id="resultsBody">
                <!-- Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© Ù‡Ù†Ø§ -->
            </tbody>
        </table>

        <div class="total-row">
            <p>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª: <span id="totalMeals">0</span></p>
            <p>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù„ÙŠØ§Ù„ÙŠ: <span id="totalNights">0</span></p>
            <p>Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©: <span id="totalCompensations">0</span> Ø¯Ø¬</p>
        </div>
    </div>

    <script>
        function addRow() {
            const tableBody = document.getElementById('inputTableBody');
            const newRow = `
                <tr>
                    <td><input type="date" class="startDate"></td>
                    <td><input type="time" class="startTime"></td>
                    <td><input type="date" class="endDate"></td>
                    <td><input type="time" class="endTime"></td>
                    <td><input type="number" class="distance" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø³Ø§ÙØ©"></td>
                    <td>
                        <select class="category">
                            <option value="Ù…Ù† 1 Ø¥Ù„Ù‰ 10">Ù…Ù† 1 Ø¥Ù„Ù‰ 10</option>
                            <option value="Ù…Ù† 11 ÙÙ…Ø§ ÙÙˆÙ‚">Ù…Ù† 11 ÙÙ…Ø§ ÙÙˆÙ‚</option>
                            <option value="Ø´Ø§ØºÙ„Ùˆ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ù„ÙŠØ§ ÙÙŠ Ø§Ù„Ø¯ÙˆÙ„Ø©">Ø´Ø§ØºÙ„Ùˆ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ù„ÙŠØ§ ÙÙŠ Ø§Ù„Ø¯ÙˆÙ„Ø©</option>
                        </select>
                    </td>
                    <td><button class="remove-button" onclick="removeRow(this)">ğŸ—‘ï¸ Ø­Ø°Ù</button></td>
                </tr>
            `;
            tableBody.insertAdjacentHTML('beforeend', newRow);
        }

        function removeRow(button) {
            button.parentElement.parentElement.remove();
        }

        function calculateAll() {
            const rows = document.querySelectorAll('#inputTableBody tr');
            const resultsBody = document.getElementById('resultsBody');
            resultsBody.innerHTML = '';
            let totalMeals = 0;
            let totalNights = 0;
            let totalCompensations = 0;

            rows.forEach(row => {
                const startDate = row.querySelector('.startDate').value;
                const startTime = row.querySelector('.startTime').value;
                const endDate = row.querySelector('.endDate').value;
                const endTime = row.querySelector('.endTime').value;
                const distance = parseFloat(row.querySelector('.distance').value);
                const category = row.querySelector('.category').value;

                if (!startDate || !startTime || !endDate || !endTime || isNaN(distance) || !category) {
                    alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ØµÙÙˆÙ Ù‚Ø¨Ù„ Ø§Ù„Ø­Ø³Ø§Ø¨!");
                    return;
                }

                if (distance <= 50) {
                    alert("Ø§Ù„Ù…Ø³Ø§ÙØ© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø£ÙƒØ¨Ø± Ù…Ù† 50 ÙƒÙŠÙ„ÙˆÙ…ØªØ±Ù‹Ø§ Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª!");
                    return;
                }

                const startDateTime = new Date(`${startDate}T${startTime}`);
                const endDateTime = new Date(`${endDate}T${endTime}`);

                if (endDateTime <= startDateTime) {
                    alert("ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨Ø¹Ø¯ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨!");
                    return;
                }

                let mealCost, nightCost;

                if (category === "Ù…Ù† 1 Ø¥Ù„Ù‰ 10") {
                    mealCost = 600;
                    nightCost = 2400;
                } else if (category === "Ù…Ù† 11 ÙÙ…Ø§ ÙÙˆÙ‚") {
                    mealCost = 800;
                    nightCost = 3200;
                } else if (category === "Ø´Ø§ØºÙ„Ùˆ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¹Ù„ÙŠØ§ ÙÙŠ Ø§Ù„Ø¯ÙˆÙ„Ø©") {
                    mealCost = 1600;
                    nightCost = 6400;
                } else {
                    alert("Ø§Ù„ØµÙ†Ù ØºÙŠØ± ØµØ§Ù„Ø­!");
                    return;
                }

                let mealCount = 0;
                let nightCount = 0;

                let currentDate = new Date(startDateTime);

                while (currentDate <= endDateTime) {
                    const dayStart = new Date(currentDate.setHours(0, 0, 0));
                    const dayEnd = new Date(currentDate.setHours(23, 59, 59));

                    if (dayEnd > endDateTime) dayEnd.setTime(endDateTime.getTime());

                    if (
                        startDateTime < new Date(dayStart).setHours(11, 0, 0) &&
                        endDateTime > new Date(dayStart).setHours(14, 0, 0)
                    ) {
                        mealCount++;
                    }
                    if (
                        startDateTime < new Date(dayStart).setHours(18, 0, 0) &&
                        endDateTime > new Date(dayStart).setHours(21, 0, 0)
                    ) {
                        mealCount++;
                    }

                    if (
                        startDateTime <= new Date(dayStart).setHours(0, 0, 0) &&
                        endDateTime >= new Date(dayStart).setHours(6, 0, 0)
                    ) {
                        nightCount++;
                    }

                    currentDate.setDate(currentDate.getDate() + 1);
                    currentDate.setHours(0, 0, 0);
                }

                const mealCompensation = mealCount * mealCost;
                const nightCompensation = nightCount * nightCost;
                const totalCompensation = mealCompensation + nightCompensation;

                resultsBody.insertAdjacentHTML('beforeend', `
                    <tr class="result-row">
                        <td>${startDate} ${startTime}</td>
                        <td>${endDate} ${endTime}</td>
                        <td>${mealCount}</td>
                        <td>${nightCount}</td>
                        <td>${totalCompensation} Ø¯Ø¬</td>
                        <td>${category}</td>
                    </tr>
                `);

                totalMeals += mealCount;
                totalNights += nightCount;
                totalCompensations += totalCompensation;
            });

            document.getElementById('totalMeals').textContent = totalMeals;
            document.getElementById('totalNights').textContent = totalNights;
            document.getElementById('totalCompensations').textContent = totalCompensations + " Ø¯Ø¬";
        }

        function downloadExcel() {
            const rows = document.querySelectorAll('#resultsBody tr');
            const data = [
                ["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø°Ù‡Ø§Ø¨", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø±Ø¬ÙˆØ¹", "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙˆØ¬Ø¨Ø§Øª", "Ø¹Ø¯Ø¯ Ø§Ù„Ù„ÙŠØ§Ù„ÙŠ", "Ø§Ù„ØªØ¹ÙˆÙŠØ¶Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©", "Ø§Ù„ØµÙ†Ù"]
            ];

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const rowData = Array.from(cells).map(cell => cell.textContent);
                data.push(rowData);
            });

            const worksheet = XLSX.utils.aoa_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø³Ø§Ø¨");
            XLSX.writeFile(workbook, "Ù†ØªØ§Ø¦Ø¬_Ø§Ù„Ø­Ø³Ø§Ø¨.xlsx");
        }
    </script>
</body>
</html>
